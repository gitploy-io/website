"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1893],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return y}});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=o.createContext({}),s=function(e){var t=o.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=s(e.components);return o.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},c=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,p=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=s(n),y=a,m=c["".concat(p,".").concat(y)]||c[y]||u[y]||r;return n?o.createElement(m,i(i({ref:t},d),{},{components:n})):o.createElement(m,i({ref:t},d))}));function y(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=c;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var s=2;s<r;s++)i[s]=n[s];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}c.displayName="MDXCreateElement"},4801:function(e,t,n){n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return p},default:function(){return y},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return u}});var o=n(7462),a=n(3366),r=(n(7294),n(3905)),i=["components"],l={sidebar_position:2},p=void 0,s={unversionedId:"concepts/deploy.yml",id:"concepts/deploy.yml",title:"deploy.yml",description:"Gitploy provides the way users can configure pipelines by a simple file, such as deployment trigger, deployment safety, and deploying to a runtime environment\ud83d\ude80. The syntax is designed to be easy to read and expressive so that anyone can understand the pipeline. You can check the documentation for the syntax of the file.",source:"@site/docs/concepts/deploy.yml.md",sourceDirName:"concepts",slug:"/concepts/deploy.yml",permalink:"/docs/concepts/deploy.yml",editUrl:"https://github.com/gitploy-io/website/tree/main/docs/concepts/deploy.yml.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"How it works",permalink:"/docs/concepts/how-it-work"},next:{title:"Deployment",permalink:"/docs/concepts/deployment"}},d={},u=[{value:"Quick Start",id:"quick-start",level:2},{value:"Deployment Trigger",id:"deployment-trigger",level:2},{value:"Auto Deploy",id:"auto-deploy",level:3},{value:"Deployment safety",id:"deployment-safety",level:2},{value:"Deployable Ref",id:"deployable-ref",level:3},{value:"Deploy Freeze Window",id:"deploy-freeze-window",level:3},{value:"Serialization",id:"serialization",level:3},{value:"Review",id:"review",level:3},{value:"Deploy \ud83d\ude80",id:"deploy-",level:2},{value:"Parameters of GitHub deployment API",id:"parameters-of-github-deployment-api",level:3},{value:"Dynamic Payload",id:"dynamic-payload",level:3}],c={toc:u};function y(e){var t=e.components,l=(0,a.Z)(e,i);return(0,r.kt)("wrapper",(0,o.Z)({},c,l,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Gitploy provides the way users can configure pipelines by a simple file, such as ",(0,r.kt)("strong",{parentName:"p"},"deployment trigger"),", ",(0,r.kt)("strong",{parentName:"p"},"deployment safety"),", and ",(0,r.kt)("strong",{parentName:"p"},"deploying")," to a runtime environment\ud83d\ude80. The syntax is designed to be easy to read and expressive so that anyone can understand the pipeline. You can check the ",(0,r.kt)("a",{parentName:"p",href:"/docs/references/deploy.yml"},"documentation")," for the syntax of the file."),(0,r.kt)("p",null,"Pipelines are configured by placing a ",(0,r.kt)("inlineCode",{parentName:"p"},"deploy.yml")," file in the root of your git repository. And if you want to change the file path, you can do it on the settings page.  "),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"\u26a0\ufe0f Note that the configuration file must be at the head of the default branch.")," "),(0,r.kt)("h2",{id:"quick-start"},"Quick Start"),(0,r.kt)("p",null,"If you want to get started quickly, you should click the ",(0,r.kt)("em",{parentName:"p"},"New Configuration")," link, copy the ",(0,r.kt)("inlineCode",{parentName:"p"},"deploy.yml")," file, and push it into your git repository. Then you can find the ",(0,r.kt)("inlineCode",{parentName:"p"},"production")," environment in the deploy tab."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Quick Start",src:n(7654).Z,width:"579",height:"268"})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="deploy.yml"',title:'"deploy.yml"'},"envs:\n  - name: production\n    auto_merge: false\n    # To avoid the context verification.\n    # required_context: []\n")),(0,r.kt)("h2",{id:"deployment-trigger"},"Deployment Trigger"),(0,r.kt)("h3",{id:"auto-deploy"},"Auto Deploy"),(0,r.kt)("p",null,"Gitploy provides continuous delivery basically, but it also provides ",(0,r.kt)("strong",{parentName:"p"},"continuous deployment"),". The deployment will be triggered automatically if any new push events are detected from GitHub.\nTo enable continuous deployment, you should configure the ",(0,r.kt)("inlineCode",{parentName:"p"},"auto_deploy_on")," field. Gitploy triggers a deployment when a ",(0,r.kt)("inlineCode",{parentName:"p"},"ref")," of the push event is matched with the field."),(0,r.kt)("p",null,"This configuration also supports a regular expression to match with the specific pattern. It allows you to deploy on any tag (i.e., ",(0,r.kt)("inlineCode",{parentName:"p"},"refs/tags/.*"),") or to match specific branches (i.e., ",(0,r.kt)("inlineCode",{parentName:"p"},"refs/heads/(main|master)"),")."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="deploy.yml"',title:'"deploy.yml"'},"envs:\n  - name: production\n    auto_deploy_on: refs/heads/main\n")),(0,r.kt)("h2",{id:"deployment-safety"},"Deployment safety"),(0,r.kt)("h3",{id:"deployable-ref"},"Deployable Ref"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"ref")," can be any named branch, tag, or SHA. But sometimes, a ",(0,r.kt)("inlineCode",{parentName:"p"},"ref")," must be specific branches or tags. ",(0,r.kt)("strong",{parentName:"p"},"You can verify a ",(0,r.kt)("inlineCode",{parentName:"strong"},"ref")," matched with the regular expression")," by configuring the ",(0,r.kt)("inlineCode",{parentName:"p"},"deployable_ref")," field. "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="deploy.yml"',title:'"deploy.yml"'},'envs:\n  - name: production\n    deployable_ref: "v.*"\n')),(0,r.kt)("h3",{id:"deploy-freeze-window"},"Deploy Freeze Window"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"If you want to prevent deployments for a particular period"),", such as during a planned vacation period or out of working time, you can configure the ",(0,r.kt)("inlineCode",{parentName:"p"},"frozen_windows")," field. During a deploy freeze period, users can not execute any deployment. "),(0,r.kt)("p",null,"And this configuration uses the cron expression to handle repetitive periods. You can check the detail in the ",(0,r.kt)("a",{parentName:"p",href:"/docs/references/deploy.yml"},"documentation"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="deploy.yml"',title:'"deploy.yml"'},'envs:\n  - name: production\n    frozen_windows:\n      # Freeze every midnights\n      - start: "50 23 * * *"\n        duration: 20m\n        location: America/New_York\n      # Freeze every weekends\n      - start: "0 * * * SAT,SUN"\n        duration: 1h\n        location: Asia/Seoul\n')),(0,r.kt)("h3",{id:"serialization"},"Serialization"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Serialization forces only one deployment to run for the same environment.")," If deployment is running for a specific environment, users cannot deploy until the deployment is finished. In particular, serialization is helpful in long-running deployment strategies, such as canary deployments, as it prevents other deployments."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="deploy.yml"',title:'"deploy.yml"'},"envs:\n  - name: production\n    serialization: true\n")),(0,r.kt)("h3",{id:"review"},"Review"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"If you require a specific person, such as a service owner or product manager, to review what is deployed before deployment"),", you can configure the ",(0,r.kt)("inlineCode",{parentName:"p"},"review")," field. You can list up users as reviewers under the ",(0,r.kt)("inlineCode",{parentName:"p"},"review")," field. Then Gitploy requests a review to users by sending a notification when a deployment is triggered."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="deploy.yml"',title:'"deploy.yml"'},'envs:\n  - name: production\n    review:\n      enabled: true\n      reviewers: ["ocotocat", "manager"]\n')),(0,r.kt)("h2",{id:"deploy-"},"Deploy \ud83d\ude80"),(0,r.kt)("h3",{id:"parameters-of-github-deployment-api"},"Parameters of GitHub deployment API"),(0,r.kt)("p",null,"As the 'How it works' documentation mentioned, Gitploy sends a request by ",(0,r.kt)("a",{parentName:"p",href:"https://docs.github.com/en/rest/reference/deployments#deployments"},"deployment API"),". You can configure all the parameters in a configuration file."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="deploy.yml"',title:'"deploy.yml"'},"envs:\n  - name: production\n    task: deploy:lambda\n    description: Deploy to the production lambda.\n    auto_merge: false\n    required_contexts:\n      - test\n      - integration-test\n    production_environment: true\n")),(0,r.kt)("h3",{id:"dynamic-payload"},"Dynamic Payload"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"This ",(0,r.kt)("inlineCode",{parentName:"strong"},"dynamic_payload")," field dynamically generates payload and passes it to the Github deployment API.")," This configuration makes deployment systems flexible and powerful. For example, it allows the canary deployment system to set the weight of traffic to shift when triggered."),(0,r.kt)("p",null,"When setting the dynamic payload, when the user presses the deploy button, an input form appears so that the user can enter the payload."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="deploy.yml"',title:'"deploy.yml"'},'envs:\n  - name: production    \n    dynamic_payload:\n      enabled: true\n      inputs:\n        canaryEnabled:\n          required: true\n          type: select\n          description: Deploy strategy\n          options:\n            - "true"\n            - "false"\n          default: "true"\n        canaryWeight:\n          required: true\n          type: number\n          description: The weight of traffic to shift.\n          default: 5\n')))}y.isMDXComponent=!0},7654:function(e,t,n){t.Z=n.p+"assets/images/quickstart-dec63d06127634e1bcf2520347b74a64.png"}}]);